<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<title>The Human Filter v4.0 ‚Äî See Through Any Message | Human Layer AI</title>
<meta name="description" content="Paste any message or upload a screenshot and see every manipulation tactic, cognitive bias, logical fallacy, and power play hidden inside. Built with legal reasoning and behavioral psychology. Powered by GPT-4o-mini.">
<meta property="og:title" content="The Human Filter v4.0 ‚Äî See Through Any Message">
<meta property="og:description" content="Paste any message and reveal hidden manipulation tactics through 5 analysis engines.">
<meta property="og:url" content="https://aakarshsharma.com/artifacts/influence-decoder.html">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary_large_image">
<meta name="author" content="Aakarsh Sharma ‚Äî Human Layer AI">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=Playfair+Display:ital,wght@0,700;1,400&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --navy:#0f1923;--navy-light:#162333;--navy-lighter:#1d2e42;--navy-card:#12202e;
  --teal:#2dd4a8;--teal-dim:rgba(45,212,168,0.12);--teal-glow:rgba(45,212,168,0.3);
  --gold:#d4a03c;--gold-dim:rgba(212,160,60,0.12);--gold-glow:rgba(212,160,60,0.3);
  --purple:#8b5cf6;--purple-dim:rgba(139,92,246,0.12);
  --red:#ef4444;--red-dim:rgba(239,68,68,0.12);--red-soft:#ff6b6b;--red-glow:rgba(239,68,68,0.3);
  --orange:#f97316;--orange-dim:rgba(249,115,22,0.12);
  --green:#10b981;--green-dim:rgba(16,185,129,0.12);--green-glow:rgba(16,185,129,0.3);
  --pink:#ec4899;--pink-dim:rgba(236,72,153,0.12);
  --cyan:#06b6d4;--cyan-dim:rgba(6,182,212,0.12);
  --yellow:#eab308;--yellow-dim:rgba(234,179,8,0.12);
  --dark-bg:#0c121c;--white:#fff;--gray:#94a3b8;--gray-light:#b4bec8;
  --font-body:'Inter',system-ui,sans-serif;--font-display:'Playfair Display',Georgia,serif;--font-mono:'JetBrains Mono',monospace;
  --radius:12px;--radius-sm:8px;--radius-lg:16px;
  --transition:all 0.3s cubic-bezier(0.4,0,0.2,1);
}
html{scroll-behavior:smooth}
body{font-family:var(--font-body);background:var(--dark-bg);color:var(--white);line-height:1.6;overflow-x:hidden;-webkit-font-smoothing:antialiased}

.header{position:sticky;top:0;z-index:100;padding:10px 16px;background:rgba(12,18,28,0.95);backdrop-filter:blur(16px);border-bottom:1px solid rgba(45,212,168,0.08);display:flex;align-items:center;justify-content:space-between}
.header-brand{display:flex;align-items:center;gap:8px}
.logo-text{font-family:var(--font-display);font-size:1rem;color:var(--gold)}
.logo-sub{font-size:0.6rem;color:var(--gray);letter-spacing:2px;text-transform:uppercase}
.header-links{display:flex;gap:10px;align-items:center}
.header-links a{font-size:0.75rem;color:var(--gray);text-decoration:none}
.header-links a:hover{color:var(--teal)}
.btn-cta{background:var(--gold);color:var(--navy);font-weight:600;font-size:0.7rem;padding:7px 14px;border-radius:20px;text-decoration:none;letter-spacing:0.5px}

.hero{text-align:center;padding:28px 16px 16px;max-width:700px;margin:0 auto}
.hero-badge{display:inline-block;font-size:0.65rem;letter-spacing:2px;text-transform:uppercase;color:var(--teal);padding:5px 14px;border:1px solid var(--teal-dim);border-radius:20px;margin-bottom:10px}
.hero h1{font-family:var(--font-display);font-size:clamp(1.6rem,4.5vw,2.5rem);line-height:1.15;margin-bottom:8px}
.hero h1 .accent{color:var(--gold);font-style:italic}
.hero-desc{color:var(--gray-light);font-size:clamp(0.78rem,2.2vw,0.88rem);max-width:500px;margin:0 auto}

.input-section{max-width:700px;margin:0 auto;padding:0 12px 12px}
.input-dual{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px}
@media(max-width:480px){.input-dual{grid-template-columns:1fr}}
.upload-zone{background:var(--purple-dim);border:2px dashed rgba(139,92,246,0.35);border-radius:var(--radius-lg);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:20px 14px;cursor:pointer;transition:var(--transition);min-height:100px;-webkit-tap-highlight-color:transparent}
.upload-zone:hover,.upload-zone:active{border-color:var(--purple);background:rgba(139,92,246,0.15)}
.upload-icon{font-size:1.8rem}
.upload-label{font-size:0.78rem;font-weight:600;color:var(--purple)}
.upload-sub{font-size:0.62rem;color:var(--gray)}
.ocr-status{font-size:0.6rem;color:var(--teal);font-style:italic;text-align:center;min-height:14px}
.paste-zone{background:var(--navy-card);border:1px solid var(--navy-lighter);border-radius:var(--radius-lg);display:flex;flex-direction:column}
.paste-header{display:flex;justify-content:space-between;align-items:center;padding:8px 12px 4px}
.paste-label{font-size:0.65rem;font-weight:600;letter-spacing:1px;text-transform:uppercase;color:var(--gray)}
.char-count{font-size:0.6rem;color:var(--gray);font-family:var(--font-mono)}
.input-area{width:100%;flex:1;min-height:80px;padding:8px 12px;background:transparent;border:none;color:var(--white);font-family:var(--font-body);font-size:0.82rem;line-height:1.6;resize:none;outline:none}
.input-area::placeholder{color:rgba(148,163,184,0.3);font-style:italic;font-size:0.78rem}
input[type="file"]{display:none}

.presets-wrap{max-width:700px;margin:0 auto;padding:0 12px 10px}
.presets{display:flex;flex-wrap:wrap;gap:5px;justify-content:center}
.preset-chip{display:inline-flex;align-items:center;gap:4px;font-size:0.66rem;padding:5px 10px;border-radius:20px;border:1px solid var(--navy-lighter);background:var(--navy-light);color:var(--gray-light);cursor:pointer;transition:var(--transition);white-space:nowrap;-webkit-tap-highlight-color:transparent}
.preset-chip:hover,.preset-chip:active{border-color:var(--teal);color:var(--teal);background:var(--teal-dim)}
.preset-chip.more-btn{border-color:rgba(212,160,60,0.3);color:var(--gold)}
.preset-chip.more-btn:hover{border-color:var(--gold);background:var(--gold-dim)}
.presets-extra{display:none;flex-wrap:wrap;gap:5px;justify-content:center;margin-top:5px}
.presets-extra.show{display:flex}

.decode-btn{display:block;width:calc(100% - 24px);max-width:676px;margin:0 auto 14px;padding:13px;font-size:0.88rem;font-weight:700;letter-spacing:1px;text-transform:uppercase;color:var(--navy);background:linear-gradient(135deg,var(--gold),#e8b84a);border:none;border-radius:var(--radius);cursor:pointer;transition:var(--transition);-webkit-tap-highlight-color:transparent}
.decode-btn:hover{filter:brightness(1.1);transform:translateY(-1px);box-shadow:0 4px 20px rgba(212,160,60,0.3)}
.decode-btn:active{transform:translateY(0)}
.decode-btn:disabled{opacity:0.6;cursor:not-allowed}

.scan-overlay{position:fixed;inset:0;z-index:999;background:rgba(12,18,28,0.96);display:none;align-items:center;justify-content:center;flex-direction:column;gap:16px}
.scan-overlay.active{display:flex}
.scan-spinner{width:44px;height:44px;border:3px solid var(--navy-lighter);border-top-color:var(--teal);border-radius:50%;animation:spin 0.8s linear infinite}
.scan-text{color:var(--teal);font-size:0.8rem;letter-spacing:1px;animation:pulse 1.5s ease infinite}
.scan-step{color:var(--gray);font-size:0.65rem;margin-top:-8px}
@keyframes spin{to{transform:rotate(360deg)}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.4}}

.results{display:none;max-width:700px;margin:0 auto;padding:0 12px 40px}
.results.visible{display:block}

.score-card{background:linear-gradient(145deg,var(--navy-card),var(--navy-light));border:1px solid var(--navy-lighter);border-radius:var(--radius-lg);padding:20px;margin-bottom:14px;text-align:center;position:relative;overflow:hidden;opacity:0;transform:translateY(16px);transition:all 0.6s cubic-bezier(0.4,0,0.2,1)}
.score-card.anim-in{opacity:1;transform:translateY(0)}
.score-card::before{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(from 0deg,transparent,rgba(45,212,168,0.03),transparent,rgba(212,160,60,0.03),transparent);animation:cardShimmer 8s linear infinite}
@keyframes cardShimmer{to{transform:rotate(360deg)}}
.score-glow{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:140px;height:140px;border-radius:50%;opacity:0;pointer-events:none}
.sc-ctx{display:inline-flex;align-items:center;gap:5px;font-size:0.62rem;letter-spacing:1.5px;text-transform:uppercase;color:var(--gray);padding:4px 10px;border:1px solid var(--navy-lighter);border-radius:12px;margin-bottom:12px;position:relative}
.sc-ctx-icon{font-size:0.8rem}
.sc-score-wrap{position:relative;width:110px;height:110px;margin:0 auto 12px}
.sc-score-wrap svg{width:110px;height:110px;transform:rotate(-90deg)}
.sc-ring-bg{fill:none;stroke:var(--navy-lighter);stroke-width:4}
.sc-ring-fill{fill:none;stroke-width:4;stroke-linecap:round;transition:stroke-dashoffset 1.5s cubic-bezier(0.4,0,0.2,1)}
.sc-num-wrap{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;flex-direction:column}
.sc-num{font-size:2.2rem;font-weight:900;line-height:1;font-family:var(--font-body)}
.sc-label{font-size:0.55rem;color:var(--gray);letter-spacing:1.5px;text-transform:uppercase;margin-top:2px}
.sc-verdict{font-size:0.78rem;color:var(--white);line-height:1.5;margin:10px auto;padding:10px 12px;background:rgba(212,160,60,0.08);border:1px solid rgba(212,160,60,0.15);border-radius:var(--radius-sm);border-left:3px solid var(--gold);font-style:italic}
.sc-tactics{display:flex;flex-wrap:wrap;gap:5px;justify-content:center;margin-bottom:10px}
.sc-tactic{font-size:0.6rem;padding:3px 9px;border-radius:10px;display:flex;align-items:center;gap:3px}
.sc-sub{display:flex;flex-wrap:wrap;gap:5px;justify-content:center}
.sc-engine{font-size:0.6rem;padding:3px 8px;border-radius:8px;background:var(--navy-lighter);color:var(--gray-light);display:flex;align-items:center;gap:3px}
.sc-engine .dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.sc-watermark{font-size:0.5rem;color:rgba(148,163,184,0.3);margin-top:10px;letter-spacing:1px}

.section-head{font-size:0.7rem;letter-spacing:1.5px;text-transform:uppercase;color:var(--gray);margin-bottom:8px;display:flex;align-items:center;gap:6px}

.xray{background:var(--navy-card);border:1px solid var(--navy-lighter);border-radius:var(--radius-lg);overflow:hidden;margin-bottom:14px;opacity:0;transform:translateY(16px);transition:all 0.6s cubic-bezier(0.4,0,0.2,1) 0.15s}
.xray.anim-in{opacity:1;transform:translateY(0)}
.xray-tabs{display:flex;border-bottom:1px solid var(--navy-lighter)}
.xray-tab{flex:1;padding:10px;text-align:center;font-size:0.7rem;font-weight:600;letter-spacing:0.5px;text-transform:uppercase;color:var(--gray);cursor:pointer;transition:var(--transition);border-bottom:2px solid transparent}
.xray-tab:hover{color:var(--white)}
.xray-tab.active{border-bottom-color:var(--teal);color:var(--teal)}
.xray-tab.t-original.active{border-bottom-color:var(--orange);color:var(--orange)}
.xray-tab.t-decoded.active{border-bottom-color:var(--green);color:var(--green)}
.xray-pane{display:none;padding:14px;min-height:100px;max-height:380px;overflow-y:auto}
.xray-pane.active{display:block}
@media(min-width:640px){
  .xray-tabs{display:none}
  .xray-panes{display:grid;grid-template-columns:1fr 1fr}
  .xray-pane{display:block !important;border-right:1px solid var(--navy-lighter)}
  .xray-pane:last-child{border-right:none}
  .xray-pane-label{display:block;font-size:0.62rem;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:8px;padding-bottom:5px;border-bottom:1px solid var(--navy-lighter);font-weight:600}
  .xray-pane-label.lbl-orig{color:var(--orange)}
  .xray-pane-label.lbl-decoded{color:var(--green)}
}
@media(max-width:639px){.xray-pane-label{display:none}.xray-panes{display:block}}
.hl{border-radius:3px;padding:1px 3px;cursor:pointer;transition:background 0.2s;position:relative}
.hl:hover{filter:brightness(1.3)}
.hl-red{background:rgba(239,68,68,0.18);border-bottom:2px solid var(--red)}
.hl-orange{background:rgba(249,115,22,0.15);border-bottom:2px solid var(--orange)}
.hl-yellow{background:rgba(234,179,8,0.12);border-bottom:2px solid var(--yellow)}
.hl-purple{background:rgba(139,92,246,0.12);border-bottom:2px solid var(--purple)}
.hl-pink{background:rgba(236,72,153,0.12);border-bottom:2px solid var(--pink)}
.hl-cyan{background:rgba(6,182,212,0.12);border-bottom:2px solid var(--cyan)}
.hl-clean{opacity:0.6}
.anno{display:none;position:absolute;left:0;top:100%;z-index:50;width:270px;max-width:88vw;background:var(--navy);border:1px solid var(--navy-lighter);border-radius:var(--radius-sm);padding:10px;box-shadow:0 8px 24px rgba(0,0,0,0.5);margin-top:6px}
.anno.show{display:block;animation:fadeUp 0.2s ease}
.anno-head{display:flex;align-items:center;gap:5px;margin-bottom:3px}
.anno-icon{font-size:0.85rem}
.anno-tactic{font-size:0.7rem;font-weight:700}
.anno-type{font-size:0.55rem;letter-spacing:1px;text-transform:uppercase;color:var(--gray);margin-bottom:5px}
.anno-desc{font-size:0.7rem;color:var(--gray-light);line-height:1.45;margin-bottom:5px}
.anno-legal{font-size:0.63rem;color:var(--cyan);display:flex;align-items:flex-start;gap:4px;margin-bottom:3px}
.anno-legal::before{content:'‚öñÔ∏è';flex-shrink:0;font-size:0.65rem}
.anno-ask{font-size:0.63rem;color:var(--gold);display:flex;align-items:flex-start;gap:4px}
.anno-ask::before{content:'‚Üí';color:var(--gold);flex-shrink:0;font-weight:700}
@keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
.decoded-line{font-family:var(--font-mono);font-size:0.76rem;line-height:1.6;margin-bottom:7px;padding:5px 8px;border-radius:var(--radius-sm);transition:background 0.2s}
.decoded-line.d-red{color:var(--red-soft);background:rgba(239,68,68,0.06)}
.decoded-line.d-orange{color:var(--orange);background:rgba(249,115,22,0.06)}
.decoded-line.d-yellow{color:var(--yellow);background:rgba(234,179,8,0.06)}
.decoded-line.d-green{color:var(--green);background:rgba(16,185,129,0.06)}
.decoded-line.d-gray{color:var(--gray);background:transparent}

.vibe-check{background:var(--navy-card);border:1px solid var(--navy-lighter);border-radius:var(--radius-lg);padding:14px;margin-bottom:14px;display:grid;grid-template-columns:1fr 1fr;gap:10px;opacity:0;transform:translateY(16px);transition:all 0.6s cubic-bezier(0.4,0,0.2,1) 0.3s}
.vibe-check.anim-in{opacity:1;transform:translateY(0)}
@media(max-width:480px){.vibe-check{grid-template-columns:1fr}}
.vibe-item{display:flex;flex-direction:column;gap:2px}
.vibe-label{font-size:0.58rem;letter-spacing:1px;text-transform:uppercase;color:var(--gray)}
.vibe-value{font-size:0.78rem;font-weight:600;color:var(--white)}

.findings{background:var(--navy-card);border:1px solid var(--navy-lighter);border-radius:var(--radius-lg);overflow:hidden;margin-bottom:14px;opacity:0;transform:translateY(16px);transition:all 0.6s cubic-bezier(0.4,0,0.2,1) 0.45s}
.findings.anim-in{opacity:1;transform:translateY(0)}
.f-tabs{display:flex;overflow-x:auto;border-bottom:1px solid var(--navy-lighter);-webkit-overflow-scrolling:touch;scrollbar-width:none}
.f-tabs::-webkit-scrollbar{display:none}
.f-tab{flex:none;padding:8px 12px;font-size:0.66rem;font-weight:600;letter-spacing:0.5px;text-transform:uppercase;color:var(--gray);cursor:pointer;border-bottom:2px solid transparent;transition:var(--transition);white-space:nowrap;display:flex;align-items:center;gap:4px}
.f-tab:hover{color:var(--white)}
.f-tab.active{color:var(--teal);border-bottom-color:var(--teal)}
.f-tab-icon{font-size:0.8rem}
.f-cnt{font-size:0.52rem;padding:1px 5px;border-radius:8px;background:var(--navy-lighter);color:var(--gray);vertical-align:middle}
.f-tab.active .f-cnt{background:var(--teal-dim);color:var(--teal)}
.f-body{padding:12px}
.f-card{background:var(--navy-light);border:1px solid var(--navy-lighter);border-left:3px solid var(--teal);border-radius:var(--radius);padding:11px;margin-bottom:9px}
.f-card:last-child{margin-bottom:0}
.f-card.high{border-left-color:var(--red)}
.f-card.medium{border-left-color:var(--orange)}
.f-card.low{border-left-color:var(--teal)}
.f-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:3px}
.f-name-wrap{display:flex;align-items:center;gap:5px}
.f-icon{font-size:0.9rem}
.f-name{font-size:0.8rem;font-weight:600}
.f-badge{font-size:0.52rem;font-weight:700;letter-spacing:0.5px;padding:2px 7px;border-radius:6px;text-transform:uppercase;flex-shrink:0}
.f-badge.high{background:var(--red-dim);color:var(--red-soft)}
.f-badge.medium{background:var(--orange-dim);color:var(--orange)}
.f-badge.low{background:var(--teal-dim);color:var(--teal)}
.f-type{font-size:0.55rem;color:var(--gray);letter-spacing:1px;text-transform:uppercase;margin-bottom:5px;margin-left:22px}
.f-desc{font-size:0.74rem;color:var(--gray-light);line-height:1.5;margin-bottom:7px}
.f-quote{font-family:var(--font-mono);font-size:0.7rem;padding:7px 9px;border-left:3px solid var(--teal);background:rgba(45,212,168,0.04);border-radius:0 var(--radius-sm) var(--radius-sm) 0;color:var(--teal);margin-bottom:7px;line-height:1.45}
.f-legal{font-size:0.66rem;color:var(--cyan);margin-bottom:3px;display:flex;gap:4px;align-items:flex-start}
.f-legal::before{content:'‚öñÔ∏è';flex-shrink:0;font-size:0.68rem}
.f-ask{font-size:0.68rem;color:var(--gold);display:flex;gap:4px;align-items:flex-start}
.f-ask::before{content:'‚Üí';font-weight:700;flex-shrink:0}

.response{background:var(--navy-card);border:1px solid var(--navy-lighter);border-radius:var(--radius-lg);padding:14px;margin-bottom:14px;opacity:0;transform:translateY(16px);transition:all 0.6s cubic-bezier(0.4,0,0.2,1) 0.55s}
.response.anim-in{opacity:1;transform:translateY(0)}
.response-text{font-family:var(--font-mono);font-size:0.76rem;color:var(--teal);line-height:1.5;padding:9px;background:rgba(45,212,168,0.04);border-radius:var(--radius-sm);border:1px solid var(--teal-dim)}
.response-copy{font-size:0.62rem;color:var(--gray);cursor:pointer;margin-top:5px;text-align:right}
.response-copy:hover{color:var(--teal)}

.legal-box{background:var(--navy-card);border:1px solid rgba(6,182,212,0.2);border-radius:var(--radius-lg);padding:14px;margin-bottom:14px;opacity:0;transform:translateY(16px);transition:all 0.6s cubic-bezier(0.4,0,0.2,1) 0.6s}
.legal-box.anim-in{opacity:1;transform:translateY(0)}
.legal-item{font-size:0.72rem;color:var(--cyan);margin-bottom:5px;display:flex;gap:5px;align-items:flex-start;line-height:1.45}
.legal-item::before{content:'‚öñÔ∏è';flex-shrink:0}
.legal-item:last-child{margin-bottom:0}

.copy-btn{display:flex;align-items:center;gap:6px;margin:0 auto;padding:10px 20px;font-size:0.72rem;font-weight:600;color:var(--teal);background:var(--teal-dim);border:1px solid rgba(45,212,168,0.2);border-radius:var(--radius);cursor:pointer;transition:var(--transition)}
.copy-btn:hover{background:rgba(45,212,168,0.2)}

.error-msg{background:rgba(239,68,68,0.1);border:1px solid rgba(239,68,68,0.3);border-radius:var(--radius);padding:12px;margin:0 auto 14px;max-width:676px;font-size:0.75rem;color:var(--red-soft)}

.footer{text-align:center;padding:20px 12px;border-top:1px solid var(--navy-lighter);margin-top:16px}
.footer p{font-size:0.65rem;color:var(--gray)}
.footer a{color:var(--gold);text-decoration:none}

@media(max-width:480px){
  .header{padding:8px 12px}
  .header-links a:not(.btn-cta){display:none}
  .hero{padding:20px 12px 12px}
  .hero h1{font-size:1.4rem}
  .upload-zone{padding:16px 12px;min-height:80px}
  .input-area{min-height:70px;font-size:0.78rem}
  .decode-btn{font-size:0.8rem;padding:12px}
  .xray-pane{padding:10px}
  .f-card{padding:9px}
  .anno{width:250px}
  .sc-score-wrap{width:100px;height:100px}
  .sc-score-wrap svg{width:100px;height:100px}
  .sc-num{font-size:1.9rem}
}

body.embed-mode .header{display:none}
body.embed-mode .hero{padding:10px 12px 8px}
body.embed-mode .hero-badge{display:none}
body.embed-mode .hero h1{font-size:1.1rem;margin-bottom:4px}
body.embed-mode .hero-desc{font-size:0.72rem;display:none}
body.embed-mode .input-section{padding:0 8px 8px}
body.embed-mode .upload-zone{min-height:60px;padding:10px 10px}
body.embed-mode .upload-icon{font-size:1.2rem}
body.embed-mode .upload-label{font-size:0.68rem}
body.embed-mode .upload-sub{display:none}
body.embed-mode .input-area{min-height:60px;font-size:0.76rem}
body.embed-mode .presets-wrap{padding:0 8px 6px}
body.embed-mode .preset-chip{font-size:0.6rem;padding:3px 8px}
body.embed-mode .decode-btn{width:calc(100% - 16px);margin:0 auto 10px;padding:10px;font-size:0.78rem}
body.embed-mode .results{padding:0 8px 16px}
body.embed-mode .score-card{padding:14px;margin-bottom:10px}
body.embed-mode .sc-score-wrap{width:80px;height:80px}
body.embed-mode .sc-score-wrap svg{width:80px;height:80px}
body.embed-mode .sc-num{font-size:1.6rem}
body.embed-mode .xray{margin-bottom:10px}
body.embed-mode .xray-pane{max-height:200px;padding:10px}
body.embed-mode .vibe-check{padding:10px;margin-bottom:10px;gap:6px}
body.embed-mode .findings{margin-bottom:10px}
body.embed-mode .f-tab{padding:6px 10px;font-size:0.6rem}
body.embed-mode .response{display:none}
body.embed-mode .legal-box{display:none}
body.embed-mode .copy-btn{display:none}
body.embed-mode .footer{display:none}
body.embed-mode .embed-cta{display:block}
body.embed-mode{overflow:hidden}

.embed-cta{display:none;text-align:center;margin:4px auto;padding:8px 18px;font-size:0.72rem;font-weight:600;color:var(--gold);text-decoration:none;letter-spacing:0.5px}
.embed-cta:hover{text-decoration:underline}

.rate-limit-notice{background:rgba(212,160,60,0.1);border:1px solid rgba(212,160,60,0.3);border-radius:var(--radius);padding:10px;margin:0 auto 12px;max-width:676px;font-size:0.7rem;color:var(--gold);text-align:center}
</style>
</head>
<body>

<header class="header">
  <div class="header-brand"><div><div class="logo-text">Human Layer AI</div><div class="logo-sub">The Human Filter</div></div></div>
  <div class="header-links">
    <a href="https://aakarshsharma.com">Portfolio</a>
    <a href="https://aakarshsharma.com/artifacts">Artifacts</a>
    <a href="https://calendly.com" class="btn-cta">Book a Call</a>
  </div>
</header>

<section class="hero">
  <div class="hero-badge">‚óè The Human Filter v4.0</div>
  <h1>What Are They <span class="accent">Really</span> Saying?</h1>
  <p class="hero-desc">Screenshot a message or paste it in. Every sentence gets X-rayed through 5 engines: persuasion, bias, logic, emotional manipulation, and power dynamics ‚Äî powered by GPT-4o-mini.</p>
</section>

<section class="input-section">
  <div class="input-dual">
    <label class="upload-zone" for="ocrFile" id="uploadZone">
      <div class="upload-icon">üì∑</div>
      <div class="upload-label">Screenshot a Message</div>
      <div class="upload-sub">Tap to upload ‚Äî we'll read the text</div>
      <input type="file" id="ocrFile" accept="image/*">
    </label>
    <div class="paste-zone">
      <div class="paste-header">
        <span class="paste-label">Or Paste Text</span>
        <span class="char-count" id="charCount">0</span>
      </div>
      <textarea class="input-area" id="inputText" placeholder="Paste a DM, email, contract clause, WhatsApp msg..."></textarea>
    </div>
  </div>
  <div class="ocr-status" id="ocrStatus"></div>
</section>

<div class="presets-wrap">
  <div class="presets" id="presets"></div>
  <div class="presets-extra" id="presetsExtra"></div>
</div>

<button class="decode-btn" id="decodeBtn" onclick="runAnalysis()">Filter This Message</button>

<div class="scan-overlay" id="scanOverlay">
  <div class="scan-spinner"></div>
  <div class="scan-text" id="scanText">Running through the Human Filter...</div>
  <div class="scan-step" id="scanStep"></div>
</div>

<section class="results" id="results">
  <div id="errorMsg"></div>
  <div id="rateLimitMsg"></div>

  <div class="score-card" id="scoreCard">
    <div class="score-glow" id="scoreGlow"></div>
    <div class="sc-ctx" id="scCtx"><span class="sc-ctx-icon" id="scCtxIcon"></span><span id="scCtxLabel"></span></div>
    <div class="sc-score-wrap"><svg viewBox="0 0 36 36"><circle class="sc-ring-bg" cx="18" cy="18" r="15"/><circle class="sc-ring-fill" id="scRing" cx="18" cy="18" r="15" stroke-dasharray="94.25" stroke-dashoffset="94.25"/></svg><div class="sc-num-wrap"><span class="sc-num" id="scNum">0</span><span class="sc-label">Influence</span></div></div>
    <div class="sc-verdict" id="scVerdict"></div>
    <div class="sc-tactics" id="scTactics"></div>
    <div class="sc-sub" id="scEngines"></div>
    <div class="sc-watermark">analyzed by the human filter v4.0 ¬∑ humanlayerai.com</div>
  </div>

  <div class="xray" id="xray">
    <div class="xray-tabs">
      <div class="xray-tab t-original active" data-pane="orig">Original (Annotated)</div>
      <div class="xray-tab t-decoded" data-pane="dec">What They Mean</div>
    </div>
    <div class="xray-panes">
      <div class="xray-pane active" id="paneOrig"><div class="xray-pane-label lbl-orig">Original ‚Äî Tap any highlight</div><div id="origContent"></div></div>
      <div class="xray-pane" id="paneDec"><div class="xray-pane-label lbl-decoded">What They Actually Mean</div><div id="decContent"></div></div>
    </div>
  </div>

  <div class="vibe-check" id="vibeCheck"></div>

  <div class="findings" id="findingsWrap"><div class="f-tabs" id="fTabs"></div><div class="f-body" id="fBody"></div></div>

  <div class="response" id="responseBox"><div class="section-head">üí¨ Suggested Response</div><div class="response-text" id="responseText"></div><div class="response-copy" onclick="copyEl('responseText')">Copy response ‚Üó</div></div>

  <div class="legal-box" id="legalBox"><div class="section-head" style="color:var(--cyan)">‚öñÔ∏è Legal Perspective</div><div id="legalContent"></div></div>

  <button class="copy-btn" onclick="copyResults()">üìã Copy Full Analysis</button>
  <a class="embed-cta" href="/artifacts/influence-decoder.html" target="_top">See full analysis with legal perspective ‚Üí</a>
</section>

<footer class="footer">
  <p>Built by <a href="https://aakarshsharma.com">Aakarsh Sharma</a> ¬∑ Law √ó Psychology √ó AI ¬∑ <a href="https://aakarshsharma.com/artifacts">More Artifacts</a></p>
  <p style="margin-top:4px;font-size:0.58rem">Analysis powered by AI. Your message is sent to OpenAI for processing. This tool runs in your browser.</p>
</footer>

<script>
if(new URLSearchParams(window.location.search).has('embed')){document.body.classList.add('embed-mode')}

const ENGINE_ICONS={PERSUASION:'üé≠',BIAS:'üß†',LOGIC:'‚ö°',EMOTIONAL:'üíî',POWER:'üëë'};
const ENGINE_COLORS={pers:'var(--orange)',bias:'var(--purple)',logic:'var(--cyan)',emo:'var(--pink)',power:'var(--red)'};
const ENGINE_LABELS={pers:'Persuasion',bias:'Bias',logic:'Logic',emo:'Emotional',power:'Power'};
const CTX_ICONS={dating:'üíò',personal:'üí¨',business:'üíº',legal:'üìú',crypto:'ü™ô',scam:'üö®',harassment:'üö©'};

const API_KEY='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';

const PRIMARY_PRESETS=['dating','guilt','whatsapp','catfish','workfavor'];
const PRESETS={
dating:{label:'üíò Dating DM',text:`Hey gorgeous üòç I know we just matched but I feel like I already know you. You're not like other girls on here ‚Äî you actually seem real. I deleted the app btw, you're the only one I'm talking to. Can I get your number? I hate texting on here. Also my premium is expiring soon so we might lose this connection üòÖ`},
guilt:{label:'üò¢ Guilt-Trip',text:`I guess I'm just not important enough for you to make time for me anymore. Remember when you used to call me every day? I sat by the phone all evening waiting. But it's fine, I'm used to being disappointed. Your father was the same way. Don't worry about me, I'll manage somehow. I always do. I just hope you don't regret this when I'm gone.`},
whatsapp:{label:'üì± WhatsApp',text:`Bro u there?? I need to talk to u urgently. Look I'm not supposed to tell anyone this but there's this crypto opportunity that's about to blow up. My cousin works at Binance and he said this coin is getting listed next week. If u put in even ‚Çπ50K now you'll 5x it easy. I already put in 2 lakhs. But u have to do it TODAY because the window closes at midnight. Don't tell anyone else ok this is insider info. Trust me bro when have I ever steered u wrong? Just use this link and deposit now. You'll thank me later üöÄ`},
catfish:{label:'üê± Catfish DM',text:`Baby I miss you so much ü•∫ I know we haven't video called yet but my camera is broken and I'm saving up for a new phone. You're the best thing that's ever happened to me. I've never felt this way about anyone. Hey so I'm in a really tough spot right now ‚Äî my mom needs surgery and I'm $500 short. I hate asking but you're the only person I trust. I'll pay you back as soon as I get paid next week, I promise. Can you send it through Zelle? I love you üíï`},
workfavor:{label:'ü§ù Work Favor',text:`Hey! So I have a HUGE favor to ask and you're literally the only person who can help. I know you're swamped but this would only take "a few minutes" of your time. Remember when I covered for you during that meeting last month? Also, Sarah from leadership specifically mentioned your name for this. It would really look bad if we dropped the ball on this one. Can you take this on by EOD? I already told the client you'd handle it üòä`},
scam:{label:'üö® Suspicious Email',text:`Dear Beloved,\nI am Mrs. Margaret Patton, a widow of late Mr. Richard Patton who was a renowned oil magnate. Before my husband died, he deposited the sum of $12.5 Million USD in a Finance House. I am contacting you because I need a trustworthy foreign partner to receive these funds on my behalf due to political instability in my country.\nYou will receive 30% of the total amount for your assistance. All I need is your full name, bank details, and a small processing fee of $450 to initiate the transfer. Please respond urgently as time is of the essence.\nGod bless you,\nMrs. Margaret Patton`},
mlm:{label:'üíé MLM Pitch',text:`Hey girl!! üíï So I know we haven't talked since high school but I've been DYING to reach out! You've been looking AMAZING on Instagram lately! üî• So I recently started my own business (finally being my own boss! üôå) and I immediately thought of YOU. I'm looking for just 3 more people to join my team this month. The starter kit is only $299 and most people make that back in their first week!! You'd be SO perfect for this. Can I send you more info? This opportunity literally changed my life! üöÄüí∞`},
fakejob:{label:'üíº Fake Job',text:`Congratulations! You've been selected for a Remote Data Entry Specialist position at GlobalTech Solutions. Salary: $75-95/hr, work from home, flexible hours. No experience needed ‚Äî we provide full training!\nTo secure your position, please complete the following:\n1. Purchase a home office setup kit ($199, reimbursed on first paycheck)\n2. Send your SSN and bank details for payroll setup\n3. Download our proprietary software from the link below\nThis offer expires in 24 hours. Reply ASAP to confirm your spot ‚Äî only 3 positions remaining!`},
phishing:{label:'üîó Phishing',text:`‚ö†Ô∏è URGENT: Your Apple ID has been compromised! Unusual sign-in detected from Moscow, Russia at 3:47 AM.\nIf this wasn't you, your account will be permanently locked in 12 hours.\n‚Üí Click here to verify your identity: apple-id-secure-verify.com/restore\nDo NOT ignore this message. Failure to verify within 12 hours will result in permanent data loss and account termination.\nApple Security Team\nRef: #INC-2026-88431`},
landlord:{label:'üè† Landlord',text:`Hi tenant. Just wanted to give you a heads up that rent is going up $400/month starting next month. Market rates have gone up significantly. Also I'll need to come by this weekend to "inspect" the unit ‚Äî no need to be home, I have a key. If you have a problem with the new rate, you're welcome to find somewhere else. I have a waiting list of people who'd love your unit. Let me know by Friday or I'll assume you agree.`},
sales:{label:'üìß Sales Email',text:`Hi [Name],\nI wanted to reach out personally because we've been watching your company's growth closely, and frankly, we're impressed. Companies like yours that are scaling this fast typically hit a critical infrastructure bottleneck within 6-9 months ‚Äî and by then, it's already too expensive to fix.\nWe've helped 247 companies in your space avoid exactly this problem, including [Well-Known Competitor] and [Industry Leader], who both saw 340% ROI within the first quarter.\nI know you're busy, so I'll be direct: we've reserved a spot for your team in our next cohort, but it closes Friday. Want me to hold it?`},
linkedin:{label:'üí¨ LinkedIn DM',text:`Hi! I came across your profile and I'm really impressed by your background. We're building something revolutionary in the AI space and your skillset is exactly what we need. I can't share too many details publicly but this is backed by a top-tier VC firm. We're pre-revenue but growing 400% MoM. The equity package alone could be worth 7 figures in 2 years. Would love to hop on a quick 15-min call this week.`},
contract:{label:'üìú Contract',text:`The Contractor agrees to assign all intellectual property rights, including but not limited to patents, copyrights, trade secrets, and moral rights, for any work product created during or tangentially related to the engagement period, in perpetuity, throughout the universe. The Contractor waives any right to attribution. Non-compete period: 36 months post-termination within any industry the Company operates or plans to operate in. Disputes shall be resolved via binding arbitration in a jurisdiction of the Company's choosing, with costs borne by the Contractor.`},
creepy:{label:'üö© Creepy DM',text:`Hey I noticed you at the coffee shop today. You probably didn't see me but I've seen you there a few times. You always look so good. I found your Instagram from the location tag. I know this might seem forward but life's too short right? We should hang out sometime. I'm a really nice guy, you'd see that if you gave me a chance. Don't leave me on read like other girls do. I just want to get to know you. What's your schedule like? I could come by when you're there again üòä`},
};

const presetsEl=document.getElementById('presets');
const presetsExtra=document.getElementById('presetsExtra');
function makeChip(k,target){
  const chip=document.createElement('div');chip.className='preset-chip';chip.innerHTML=PRESETS[k].label;
  chip.onclick=()=>{document.getElementById('inputText').value=PRESETS[k].text;updateCC();document.getElementById('inputText').scrollIntoView({behavior:'smooth',block:'center'})};
  target.appendChild(chip);
}
PRIMARY_PRESETS.forEach(k=>makeChip(k,presetsEl));
const moreBtn=document.createElement('div');moreBtn.className='preset-chip more-btn';moreBtn.innerHTML='+ More';
moreBtn.onclick=()=>{presetsExtra.classList.toggle('show');moreBtn.innerHTML=presetsExtra.classList.contains('show')?'‚àí Less':'+ More'};
presetsEl.appendChild(moreBtn);
Object.keys(PRESETS).filter(k=>!PRIMARY_PRESETS.includes(k)).forEach(k=>makeChip(k,presetsExtra));

function updateCC(){
  const len=document.getElementById('inputText').value.length;
  document.getElementById('charCount').textContent=len;
}
document.getElementById('inputText').addEventListener('input',updateCC);

document.getElementById('ocrFile').addEventListener('change',async e=>{
  const file=e.target.files[0];
  if(!file)return;
  document.getElementById('ocrStatus').textContent='Processing screenshot...';
  try{
    if(!window.Tesseract){
      const script=document.createElement('script');
      script.src='https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js';
      await new Promise((res,rej)=>{script.onload=res;script.onerror=rej;document.head.appendChild(script);});
    }
    const {data:{text}}=await Tesseract.recognize(file,'eng');
    document.getElementById('inputText').value=text;
    updateCC();
    document.getElementById('ocrStatus').textContent='‚úì Text extracted!';
    setTimeout(()=>{document.getElementById('ocrStatus').textContent=''},2000);
  }catch(err){
    document.getElementById('ocrStatus').textContent='‚ùå OCR failed. Try a clearer image.';
  }
});

function getScore(data){
  if(!data.findings||data.findings.length===0)return 5;
  let score=0;
  data.findings.forEach(f=>{
    if(f.severity==='high')score+=15;
    else if(f.severity==='medium')score+=8;
    else if(f.severity==='low')score+=3;
  });
  return Math.min(100,Math.max(0,score));
}

function getColorForScore(s){
  if(s<20)return'var(--green)';
  if(s<40)return'var(--gold)';
  if(s<70)return'var(--orange)';
  return'var(--red)';
}

function getRateLimitRemaining(){
  const key='humanfilter_usage_'+new Date().toDateString();
  const data=JSON.parse(localStorage.getItem(key)||'{"count":0,"lastTime":0}');
  const now=Date.now();
  if(now-data.lastTime>15000){
    data.count=0;
    data.lastTime=now;
  }
  return {count:data.count,lastTime:data.lastTime,day:key};
}

function checkRateLimit(){
  const limit=getRateLimitRemaining();
  if(limit.count>=1){
    const waitSecs=Math.ceil((15000-(Date.now()-limit.lastTime))/1000);
    return{allowed:false,message:`Please wait ${waitSecs}s before next analysis.`};
  }
  const dayKey='humanfilter_daily_'+new Date().toDateString();
  const daily=JSON.parse(localStorage.getItem(dayKey)||'{"count":0}');
  if(daily.count>=30){
    return{allowed:false,message:'Daily limit reached (30/day). Please try again tomorrow.'};
  }
  return{allowed:true};
}

function recordAnalysis(){
  const key='humanfilter_usage_'+new Date().toDateString();
  const data=JSON.parse(localStorage.getItem(key)||'{"count":0,"lastTime":0}');
  data.count=1;
  data.lastTime=Date.now();
  localStorage.setItem(key,JSON.stringify(data));

  const dayKey='humanfilter_daily_'+new Date().toDateString();
  const daily=JSON.parse(localStorage.getItem(dayKey)||'{"count":0}');
  daily.count++;
  localStorage.setItem(dayKey,JSON.stringify(daily));
}

async function runAnalysis(){
  const text=document.getElementById('inputText').value.trim();
  if(!text){alert('Please enter or upload a message.');return;}

  const limit=checkRateLimit();
  if(!limit.allowed){
    document.getElementById('rateLimitMsg').innerHTML=`<div class="rate-limit-notice">${limit.message}</div>`;
    return;
  }
  document.getElementById('rateLimitMsg').innerHTML='';
  document.getElementById('errorMsg').innerHTML='';

  document.getElementById('scanOverlay').classList.add('active');
  document.getElementById('decodeBtn').disabled=true;

  try{
    const systemPrompt=`You are The Human Filter ‚Äî an AI analysis engine built by a legal professional and behavioral psychologist. Analyze messages for hidden manipulation.

Analyze the message through these 5 engines:
1. PERSUASION: Cialdini principles, dark patterns, manipulation tactics
2. COGNITIVE BIAS: anchoring, survivorship bias, bandwagon, sunk cost, etc.
3. LOGICAL FALLACIES: false dilemma, ad hominem, circular reasoning, etc.
4. EMOTIONAL MANIPULATION: guilt-tripping, love bombing, gaslighting, conditional love, etc.
5. POWER DYNAMICS: implicit threats, boundary violations, deadline coercion, IP grabs, harassment

Return ONLY valid JSON (no markdown, no code fences) with this exact structure:
{
  "score": <0-100 influence/manipulation score>,
  "context": "<dating|personal|business|legal|crypto|scam|harassment>",
  "verdict": "<One compelling sentence summarizing the overall manipulation pattern>",
  "findings": [
    {
      "engine": "<PERSUASION|BIAS|LOGIC|EMOTIONAL|POWER>",
      "name": "<Tactic Name>",
      "severity": "<high|medium|low>",
      "quote": "<exact quote from the message>",
      "decoded": "<What this actually means in plain language>",
      "legal": "<Legal perspective on this tactic>",
      "ask": "<Question the reader should ask themselves>"
    }
  ],
  "xray": [
    {
      "original": "<Original sentence from the message>",
      "decoded": "<What they actually mean>",
      "severity": "<high|medium|low|clean>"
    }
  ],
  "vibe": {
    "tone": "<emoji + short description>",
    "red_flags": "<count and names>",
    "recommended_move": "<what to do>",
    "pattern": "<overall pattern name>"
  },
  "response": "<A suggested reply the user can send>",
  "legal_notes": ["<Array of legal observations>"]
}`;

    const response=await fetch('https://api.openai.com/v1/chat/completions',{
      method:'POST',
      headers:{'Content-Type':'application/json','Authorization':`Bearer ${API_KEY}`},
      body:JSON.stringify({
        model:'gpt-4o-mini',
        messages:[
          {role:'system',content:systemPrompt},
          {role:'user',content:`Analyze this message:\n\n${text}`}
        ],
        temperature:0.7,
        max_tokens:2000
      })
    });

    if(!response.ok){
      throw new Error(`API error: ${response.status}`);
    }

    const json=await response.json();
    let content=json.choices[0].message.content.trim();
    if(content.startsWith('```json')){content=content.replace(/^```json\n?/,'').replace(/\n?```$/,'');}
    if(content.startsWith('```')){content=content.replace(/^```\n?/,'').replace(/\n?```$/,'');}

    const data=JSON.parse(content);
    recordAnalysis();
    displayResults(data,text);
  }catch(err){
    document.getElementById('errorMsg').innerHTML=`<div class="error-msg">‚ùå Analysis failed: ${err.message}. Please try again.</div>`;
  }finally{
    document.getElementById('scanOverlay').classList.remove('active');
    document.getElementById('decodeBtn').disabled=false;
  }
}

function displayResults(data,originalText){
  const resultsEl=document.getElementById('results');
  resultsEl.classList.add('visible');

  setTimeout(()=>resultsEl.scrollIntoView({behavior:'smooth',block:'start'}),100);

  const score=data.score||getScore(data);
  const ctx=data.context||'personal';
  const color=getColorForScore(score);

  document.getElementById('scCtxIcon').textContent=CTX_ICONS[ctx]||'üìå';
  document.getElementById('scCtxLabel').textContent=ctx.toUpperCase();
  document.getElementById('scNum').textContent='0';
  document.getElementById('scVerdict').textContent=data.verdict||'Hidden manipulation detected.';

  const glow=document.getElementById('scoreGlow');
  glow.style.background=`radial-gradient(circle, ${color} 0%, transparent 70%)`;
  glow.style.opacity='0.4';
  glow.style.filter=`blur(20px)`;

  const ring=document.getElementById('scRing');
  const circumference=2*Math.PI*15;
  ring.setAttribute('stroke-dasharray',circumference);
  ring.setAttribute('stroke',color);

  let current=0;
  const interval=setInterval(()=>{
    current++;
    if(current<=score){
      const offset=circumference-(current/100)*circumference;
      ring.setAttribute('stroke-dashoffset',offset);
      document.getElementById('scNum').textContent=current;
    }else{
      clearInterval(interval);
    }
  },15);

  const scoreCard=document.getElementById('scoreCard');
  setTimeout(()=>scoreCard.classList.add('anim-in'),10);

  if(data.findings&&data.findings.length>0){
    const top3=data.findings.slice(0,3);
    const tactics=document.getElementById('scTactics');
    tactics.innerHTML=top3.map(f=>`<div class="sc-tactic" style="background:${f.severity==='high'?'var(--red-dim)':f.severity==='medium'?'var(--orange-dim)':'var(--teal-dim)'};color:${f.severity==='high'?'var(--red)':f.severity==='medium'?'var(--orange)':'var(--teal)'}">${f.name}</div>`).join('');
  }

  const engines=new Set();
  if(data.findings){
    data.findings.forEach(f=>{
      const e=f.engine.toLowerCase();
      if(e==='persuasion')engines.add('pers');
      else if(e==='bias')engines.add('bias');
      else if(e==='logic')engines.add('logic');
      else if(e==='emotional')engines.add('emo');
      else if(e==='power')engines.add('power');
    });
  }
  const egHTML=[...engines].map(e=>`<div class="sc-engine"><div class="dot" style="background:${ENGINE_COLORS[e]}"></div>${ENGINE_LABELS[e]}</div>`).join('');
  document.getElementById('scEngines').innerHTML=egHTML;

  if(data.xray&&data.xray.length>0){
    const orig=document.getElementById('origContent');
    const dec=document.getElementById('decContent');

    orig.innerHTML=data.xray.map((x,i)=>{
      const hl=x.severity==='high'?'hl-red':x.severity==='medium'?'hl-orange':x.severity==='low'?'hl-yellow':'hl-clean';
      return`<span class="hl ${hl}" onclick="toggleAnno(${i})">${x.original}</span> `;
    }).join('');

    dec.innerHTML=data.xray.map(x=>{
      const cc=x.severity==='high'?'d-red':x.severity==='medium'?'d-orange':x.severity==='low'?'d-yellow':'d-gray';
      return`<div class="decoded-line ${cc}">${x.decoded}</div>`;
    }).join('');
  }

  const xray=document.getElementById('xray');
  setTimeout(()=>xray.classList.add('anim-in'),150);

  if(data.vibe){
    const vibe=document.getElementById('vibeCheck');
    vibe.innerHTML=`
      <div class="vibe-item"><div class="vibe-label">üéØ Tone</div><div class="vibe-value">${data.vibe.tone||'‚Äî'}</div></div>
      <div class="vibe-item"><div class="vibe-label">‚ö†Ô∏è Red Flags</div><div class="vibe-value">${data.vibe.red_flags||'‚Äî'}</div></div>
      <div class="vibe-item"><div class="vibe-label">‚úÖ Move</div><div class="vibe-value">${data.vibe.recommended_move||'‚Äî'}</div></div>
      <div class="vibe-item"><div class="vibe-label">üé≠ Pattern</div><div class="vibe-value">${data.vibe.pattern||'‚Äî'}</div></div>
    `;
    setTimeout(()=>vibe.classList.add('anim-in'),300);
  }

  if(data.findings&&data.findings.length>0){
    const engines={};
    data.findings.forEach(f=>{
      const e=f.engine.toUpperCase();
      if(!engines[e])engines[e]=[];
      engines[e].push(f);
    });

    const tabs=document.getElementById('fTabs');
    const body=document.getElementById('fBody');
    const icons={PERSUASION:'üé≠',BIAS:'üß†',LOGIC:'‚ö°',EMOTIONAL:'üíî',POWER:'üëë'};

    tabs.innerHTML=Object.keys(engines).map((e,i)=>`<div class="f-tab ${i===0?'active':''}" onclick="switchFTab('${e}')">${icons[e]} ${e} <span class="f-cnt">${engines[e].length}</span></div>`).join('');

    let html='';
    Object.keys(engines).forEach((e,i)=>{
      html+=`<div id="ftab-${e}" style="display:${i===0?'block':'none'}">`;
      engines[e].forEach(f=>{
        html+=`<div class="f-card ${f.severity}">
          <div class="f-top">
            <div class="f-name-wrap"><span class="f-icon">${icons[e]}</span><span class="f-name">${f.name}</span></div>
            <div class="f-badge ${f.severity}">${f.severity.toUpperCase()}</div>
          </div>
          <div class="f-type">${f.engine}</div>
          <div class="f-desc">${f.decoded}</div>
          <div class="f-quote">"${f.quote}"</div>
          <div class="f-legal">${f.legal}</div>
          <div class="f-ask">${f.ask}</div>
        </div>`;
      });
      html+='</div>';
    });
    body.innerHTML=html;

    const findings=document.getElementById('findingsWrap');
    setTimeout(()=>findings.classList.add('anim-in'),450);
  }

  if(data.response){
    document.getElementById('responseText').textContent=data.response;
    const resp=document.getElementById('responseBox');
    setTimeout(()=>resp.classList.add('anim-in'),550);
  }

  if(data.legal_notes&&data.legal_notes.length>0){
    document.getElementById('legalContent').innerHTML=data.legal_notes.map(n=>`<div class="legal-item">${n}</div>`).join('');
    const legal=document.getElementById('legalBox');
    setTimeout(()=>legal.classList.add('anim-in'),600);
  }
}

window.switchFTab=function(e){
  document.querySelectorAll('.f-tab').forEach(t=>t.classList.remove('active'));
  document.querySelectorAll('[id^="ftab-"]').forEach(p=>p.style.display='none');
  event.target.closest('.f-tab').classList.add('active');
  document.getElementById(`ftab-${e}`).style.display='block';
};

window.copyEl=function(id){
  const text=document.getElementById(id).textContent;
  navigator.clipboard.writeText(text).then(()=>{
    const btn=event.target;
    const orig=btn.textContent;
    btn.textContent='Copied!';
    setTimeout(()=>{btn.textContent=orig;},1500);
  });
};

window.copyResults=function(){
  const text=document.getElementById('inputText').value;
  const num=document.getElementById('scNum').textContent;
  const verdict=document.getElementById('scVerdict').textContent;
  const findings=Array.from(document.querySelectorAll('.f-card')).map(c=>c.textContent).join('\n\n');
  const response=document.getElementById('responseText').textContent;
  const report=`THE HUMAN FILTER v4.0 ANALYSIS\n\nScore: ${num}/100\nVerdict: ${verdict}\n\nOriginal Message:\n${text}\n\nFindings:\n${findings}\n\nSuggested Response:\n${response}`;
  navigator.clipboard.writeText(report).then(()=>{
    const btn=event.target;
    const orig=btn.textContent;
    btn.textContent='‚úì Copied!';
    setTimeout(()=>{btn.textContent=orig;},1500);
  });
};

window.addEventListener('load',()=>{
  setTimeout(()=>{
    document.getElementById('inputText').value=PRESETS.guilt.text;
    updateCC();
    runAnalysis();
  },800);
});
</script>
</body>
</html>
